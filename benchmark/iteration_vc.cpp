#include <math.h>
#include <stdio.h>
#include <unistd.h>

#include <algorithm>
#include <cassert>
#include <deque>
#include <fstream>
#include <iostream>
#include <queue>
#include <set>
#include <vector>

#include "adj_list.h"
#include "omp.h"
#include "benchmark_definitions.h"
#include "command_line.h"
#include "common_util.h"
#include "csv_log.h"
#include "edgekey.h"
#include "graph_engine.h"
#include "graph_exception.h"
#include "platform_atomics.h"
#include "pvector.h"
#include "standard_graph.h"
#include "times.h"

int main(int argc, char* argv[])
{
    std::cout << "Running Iteration" << std::endl;
    CmdLineApp iter_cli(argc, argv);
    if (!iter_cli.parse_args())
    {
        return -1;
    }


    cmdline_opts opts = iter_cli.get_parsed_opts();
    opts.stat_log += "/" + opts.db_name;

    const int THREAD_NUM = omp_get_max_threads();
    std::cout << "THREAD_NUM: " << THREAD_NUM << std::endl;
    Times t;
    t.start();
    GraphEngine graphEngine(THREAD_NUM, opts);
    graphEngine.calculate_thread_offsets();
    t.stop();
    std::cout << "Graph loaded in " << t.t_micros() << std::endl;

    std::vector<int> sampled{7964, 9472, 17312, 17340, 17987, 23377, 66607, 77610, 78361, 85437, 104243, 104570, 107358, 118766, 137406, 142855, 156306, 158960, 160629, 165147, 177102, 183235, 197935, 198589, 199352, 200147, 205319, 216506, 218103, 219153, 221067, 227396, 228950, 229314, 236589, 239106, 258467, 264473, 265019, 281223, 283861, 292237, 298455, 299381, 341316, 365718, 367564, 369159, 376010, 383140, 384007, 390430, 390886, 391808, 413147, 415326, 431132, 438162, 445119, 453076, 456592, 457911, 471995, 474941, 475442, 477477, 485159, 495503, 510139, 511633, 514207, 528277, 529101, 539101, 570656, 571262, 579993, 580011, 582070, 584753, 587626, 588764, 589907, 601525, 639599, 643874, 652583, 655952, 658868, 660371, 666677, 668604, 672317, 673037, 673558, 679109, 679925, 683244, 691537, 692358, 696489, 711170, 722029, 727778, 734919, 735678, 739332, 742131, 746906, 748385, 752368, 756261, 758524, 761375, 761520, 765246, 766208, 780008, 780020, 782476, 784537, 784803, 795273, 797434, 799092, 802956, 804097, 805410, 805726, 806096, 806962, 812633, 816002, 832366, 834354, 837590, 842406, 842500, 845929, 846839, 848431, 851204, 871134, 871369, 893064, 912760, 913013, 914545, 914675, 915568, 918994, 922094, 925429, 926729, 928312, 930394, 932902, 936807, 938597, 944986, 946972, 947961, 954423, 963348, 974434, 981630, 985023, 988782, 992738, 998900, 1005250, 1006241, 1008999, 1027825, 1028666, 1034301, 1046048, 1050816, 1051716, 1053380, 1054142, 1067892, 1068856, 1070611, 1073823, 1074764, 1077314, 1086200, 1086384, 1091288, 1096127, 1097552, 1111406, 1131591, 1141377, 1143693, 1144200, 1147328, 1148884, 1150490, 1152041, 1153605, 1154389, 1154977, 1161057, 1165277, 1171242, 1172473, 1184453, 1186157, 1189534, 1189844, 1190781, 1191357, 1192022, 1197612, 1199708, 1204915, 1210634, 1211750, 1212797, 1214158, 1219892, 1222052, 1225420, 1240146, 1242706, 1243472, 1255001, 1255875, 1256705, 1262288, 1263294, 1269778, 1272710, 1273615, 1278106, 1288710, 1294423, 1297159, 1298508, 1298909, 1304418, 1305436, 1316610, 1320559, 1325231, 1326880, 1327438, 1328985, 1335338, 1338234, 1338249, 1340364, 1344097, 1351338, 1351555, 1353686, 1354046, 1358963, 1360021, 1362342, 1379464, 1384644, 1388254, 1389817, 1397433, 1399734, 1402021, 1403595, 1403809, 1404632, 1405342, 1406744, 1410194, 1417825, 1418820, 1422342, 1425355, 1426793, 1428221, 1431662, 1433388, 1437003, 1438072, 1444069, 1448554, 1449583, 1460706, 1466110, 1467183, 1473644, 1473842, 1479485, 1479887, 1482711, 1485329, 1493767, 1494780, 1497748, 1502052, 1514006, 1517648, 1518026, 1518461, 1518705, 1521451, 1524863, 1525358, 1527348, 1532436, 1537605, 1538346, 1539347, 1539451, 1540327, 1542025, 1542508, 1543572, 1557066, 1557257, 1564964, 1565798, 1566248, 1570187, 1572008, 1573321, 1577054, 1577794, 1583980, 1584060, 1585124, 1585557, 1589847, 1590006, 1593172, 1598085, 1599057, 1600178, 1602350, 1602745, 1603830, 1616032, 1618930, 1620692, 1621809, 1628302, 1631872, 1631894, 1634166, 1640189, 1641440, 1641752, 1648251, 1648408, 1653267, 1653771, 1655977, 1657875, 1658392, 1663154, 1669652, 1670880, 1671106, 1676495, 1679988, 1682405, 1684702, 1685037, 1689684, 1690022, 1693169, 1693405, 1705209, 1707533, 1712342, 1712460, 1712561, 1716598, 1721664, 1721775, 1724888, 1734075, 1735165, 1738515, 1743258, 1743871, 1748485, 1748734, 1754022, 1756955, 1758708, 1760458, 1765964, 1767921, 1767995, 1773256, 1774915, 1776318, 1778570, 1781790, 1789477, 1790389, 1796405, 1797196, 1798205, 1802491, 1806508, 1810567, 1811614, 1811706, 1815067, 1818041, 1820119, 1822270, 1822778, 1831263, 1832312, 1833417, 1835612, 1836601, 1840523, 1846008, 1846187, 1850205, 1851168, 1857220, 1858749, 1866565, 1868286, 1870399, 1872932, 1872943, 1873211, 1874197, 1879626, 1880872, 1881359, 1882524, 1883062, 1886201, 1887395, 1887862, 1899688, 1907527, 1914301, 1917917, 1918226, 1920354, 1925142, 1927728, 1934677, 1934855, 1935515, 1937631, 1937669, 1941244, 1947627, 1947696, 1949055, 1949354, 1949723, 1949996, 1965038, 1966741, 1970713, 1975557, 1980714, 1983634, 1984996, 1985787, 1986521, 1989004, 1989633, 1990675, 1996927, 2001313, 2002523, 2003341, 2004313, 2004702, 2015219, 2019835, 2021493, 2028934, 2029170, 2029524, 2033240, 2034422, 2035450, 2036167, 2037144, 2039741, 2039798, 2042176, 2042341, 2042877, 2050769, 2055246, 2059719, 2060377, 2061378, 2061605, 2065825, 2066185, 2072693, 2075036, 2075264, 2075683, 2079600, 2080783, 2082028, 2082952, 2083339, 2085453, 2086087, 2088427, 2094188, 2099295, 2102154, 2103619, 2104321, 2105274, 2110060, 2110143, 2111284, 2111826, 2119478, 2120840, 2121724, 2124263, 2125207, 2126130, 2128893, 2128929, 2131792, 2136030, 2138850, 2140860, 2146577, 2149161, 2153541, 2153659, 2155861, 2159812, 2160793, 2163309, 2165562, 2165819, 2167196, 2167207, 2169938, 2176042, 2177984, 2180663, 2185084, 2188766, 2189383, 2190556, 2194753, 2195067, 2198207, 2199688, 2204755, 2208016, 2208655, 2210117, 2210349, 2214981, 2216102, 2219652, 2223752, 2225225, 2229306, 2229463, 2229878, 2238933, 2241378, 2242811, 2244322, 2245547, 2246084, 2247870, 2252764, 2260381, 2267558, 2268087, 2272529, 2275019, 2275156, 2288484, 2289238, 2289730, 2293095, 2300098, 2303992, 2306292, 2309997, 2311937, 2314490, 2318648, 2322163, 2324295, 2329394, 2330591, 2333887, 2334106, 2334875, 2336724, 2339527, 2340215, 2344065, 2344393, 2345441, 2349867, 2352529, 2355035, 2355548, 2355823, 2356806, 2359208, 2362086, 2363168, 2371039, 2371127, 2372269, 2373096, 2373574, 2383220, 2384317, 2387518, 2393663, 2393784, 2399321, 2401434, 2401690, 2403643, 2403780, 2411834, 2412885, 2413021, 2413807, 2420939, 2422011, 2422230, 2424172, 2424895, 2426995, 2427731, 2431899, 2432487, 2434536, 2438006, 2439193, 2442001, 2444830, 2449758, 2466980, 2467643, 2472825, 2475435, 2476788, 2479653, 2480029, 2480031, 2485994, 2490162, 2499458, 2499877, 2500605, 2501481, 2503630, 2506904, 2514112, 2514536, 2517823, 2518001, 2518760, 2518798, 2523377, 2525505, 2527839, 2528565, 2529004, 2534175, 2534328, 2534738, 2536041, 2537286, 2537663, 2538373, 2538705, 2540969, 2541965, 2544056, 2545314, 2551311, 2556270, 2556307, 2557814, 2559751, 2561168, 2561207, 2562839, 2563255, 2567321, 2567479, 2578031, 2578708, 2579522, 2579674, 2582888, 2584283, 2584684, 2586401, 2587731, 2588505, 2589111, 2595281, 2595452, 2596236, 2598299, 2599840, 2600920, 2602651, 2603438, 2603701, 2604267, 2605202, 2606888, 2607221, 2611363, 2612469, 2614290, 2623176, 2624675, 2624993, 2630051, 2634757, 2634943, 2638881, 2642218, 2644309, 2644782, 2645073, 2645251, 2646705, 2649083, 2649694, 2651713, 2652218, 2653770, 2654628, 2656809, 2657601, 2660498, 2665139, 2665902, 2666557, 2670627, 2670976, 2671404, 2672113, 2674744, 2675982, 2676238, 2677324, 2680069, 2683094, 2683914, 2684717, 2687727, 2689196, 2689854, 2689988, 2691432, 2697479, 2698451, 2700441, 2701229, 2702850, 2705518, 2706395, 2706660, 2707223, 2709425, 2713526, 2716542, 2717727, 2720460, 2730320, 2731421, 2731670, 2735779, 2738013, 2739626, 2740908, 2742181, 2744394, 2745257, 2746550, 2746573, 2746716, 2746802, 2749330, 2749756, 2750239, 2750934, 2754320, 2755905, 2756457, 2756855, 2758303, 2758502, 2759779, 2760531, 2762164, 2772628, 2773450, 2774712, 2776538, 2778146, 2779426, 2779851, 2780567, 2783345, 2784384, 2784699, 2791080, 2793909, 2795946, 2796390, 2797303, 2802216, 2804460, 2805235, 2808063, 2810674, 2812728, 2812924, 2813058, 2815086, 2815262, 2816372, 2817164, 2822134, 2823836, 2824536, 2826578, 2827223, 2827772, 2830317, 2832042, 2832700, 2834067, 2835510, 2837482, 2838645, 2838817, 2838970, 2839823, 2842037, 2844744, 2846966, 2849595, 2849621, 2850017, 2850574, 2852226, 2853790, 2855484, 2856638, 2857157, 2857845, 2858815, 2858823, 2859118, 2859899, 2860697, 2862102, 2863376, 2863925, 2865309, 2866228, 2868501, 2869685, 2870631, 2871900, 2873205, 2873875, 2878189, 2878785, 2879581, 2880286, 2880398, 2882830, 2884174, 2885201, 2885875, 2886416, 2887844, 2890152, 2890896, 2896525, 2902941, 2905767, 2906949, 2907651, 2907687, 2907690, 2907722, 2907882, 2910419, 2914021, 2915192, 2915867, 2917049, 2919390, 2919956, 2920783, 2921299, 2925054, 2927767, 2927975, 2928470, 2929164, 2929800, 2930133, 2931408, 2931559, 2932010, 2933239, 2933900, 2936981, 2937925, 2938128, 2938386, 2939830, 2946222, 2946569, 2955037, 2958474, 2962113, 2963330, 2963470, 2964497, 2965453, 2965982, 2967303, 2968486, 2972396, 2973032, 2976616, 2981644, 2984427, 2984607, 2984796, 2985501, 2987139, 2988064, 2988763, 2989198, 2991903, 2992845, 2993942, 2997040, 2999668, 3003867, 3004050, 3004680, 3005211, 3009348, 3009828, 3015016, 3018575, 3018794, 3020711, 3021601, 3023312, 3024461, 3028909, 3029123, 3029164, 3031820, 3035557, 3035673, 3035849, 3036791, 3037231, 3037613, 3038726, 3039139, 3039210, 3040345, 3040762, 3040960, 3042247, 3049715, 3050540, 3052241, 3052514, 3056514, 3057700, 3058185, 3060339, 3060611, 3061630, 3062600, 3062772, 3064682, 3066499, 3067542, 3068016, 3069813, 3070092, 3070297, 3070956, 3075516, 3075778, 3076651, 3080195, 3080546, 3082584, 3085107, 3085235, 3088919, 3093740, 3095425, 3096488, 3098182, 3100758, 3102672, 3102736, 3104622, 3106209, 3106246, 3107036, 3108820, 3109850, 3109949, 3110298, 3112351, 3113672, 3116148, 3117011, 3120394, 3120735, 3121635, 3126312, 3127203, 3130188, 3130343, 3132105, 3135253, 3135853, 3136121, 3140792, 3141111, 3141657, 3142883, 3143676, 3144408, 3145543, 3148627, 3150515, 3151678, 3154428, 3155387, 3155476, 3155974, 3156310, 3156896, 3157345, 3159224, 3159575, 3160345, 3160571, 3161219, 3162411, 3162981, 3163365, 3164690, 3165133, 3167380, 3170888, 3173098, 3174669, 3175798, 3176734, 3177024, 3177596, 3185994, 3186063, 3186648, 3188015, 3188583, 3190676, 3194154, 3195629, 3197189, 3197251, 3197997, 3199037, 3199311, 3200801, 3200884, 3201237, 3201750, 3204321, 3204983, 3205607, 3207389, 3207889, 3209907, 3210964, 3211367, 3215483, 3216337, 3219454, 3223117, 3225299, 3227101, 3227440, 3230507, 3232354, 3241221, 3241842, 3242587, 3243089, 3243736, 3244739, 3245597, 3245941, 3247026, 3247343, 3248224, 3248938, 3250121, 3250219, 3250264, 3254618, 3255039, 3255056, 3255144, 3256311, 3257305, 3258398, 3258854, 3260329, 3262947, 3264494, 3267745, 3271510, 3273399, 3273633, 3273901, 3274097, 3275814, 3276607, 3278042, 3283675, 3284994, 3285924, 3286361, 3287050, 3287303, 3287743, 3288129, 3289844, 3290455, 3291525, 3291729, 3291811, 3293403, 3294687, 3294773, 3295640, 3296379, 3299865, 3300295, 3300667, 3300949, 3301603, 3301843, 3302717, 3303252, 3307156, 3309910, 3312014, 3312101, 3312633, 3313927, 3315857, 3317069, 3317580, 3318180, 3320762, 3322298, 3323277, 3323438, 3329288, 3329852, 3330668, 3330792, 3331247, 3332443, 3332895, 3334604, 3337212, 3338174, 3339338, 3340813, 3341519, 3342416, 3344206, 3345543, 3345795, 3346541, 3347060, 3348050, 3349213, 3350071, 3351238, 3351398, 3352470, 3353628, 3355090, 3355685, 3356013, 3356157, 3356684, 3358284, 3360726, 3362568, 3362595, 3363427, 3363768, 3365317, 3367259, 3367996, 3368863, 3368936, 3371206, 3373195, 3375068, 3376237, 3378585, 3379364, 3381351, 3381886, 3382042, 3385319, 3388704, 3390847, 3391696, 3392905, 3393302, 3394015, 3395384, 3396130, 3398563, 3405457, 3408311, 3408565, 3408968, 3409022, 3409114, 3409887, 3414429, 3416376, 3416715, 3420791, 3421637, 3421957, 3422855, 3423798, 3424034, 3424982, 3426671, 3433470, 3433806, 3434053, 3435896, 3436800, 3438444, 3438574, 3440596, 3442034, 3442148, 3442588, 3443656, 3443938, 3446219, 3449357, 3450013, 3450067, 3451032, 3453527, 3458160, 3459282, 3459566, 3462159, 3466559, 3467944, 3468363, 3469378, 3469489, 3470883, 3471111, 3471403, 3471422, 3471454, 3473930, 3474822, 3475781, 3475783, 3476204, 3478455, 3479441, 3482955, 3483860, 3486201, 3486861, 3491126, 3491692, 3492713, 3494355, 3496590, 3497445, 3497643, 3502034, 3502172, 3506815, 3507798, 3510623, 3511264, 3511706, 3512712, 3513838, 3515392, 3516698, 3516795, 3517045, 3517415, 3517703, 3519241, 3519444, 3520418, 3521853, 3523725, 3524753, 3525247, 3526103, 3527316, 3527512, 3529463, 3531119, 3531552, 3531799, 3532327, 3534511, 3535618, 3538862, 3540207, 3540823, 3541596, 3542551, 3542561, 3543236, 3543692, 3544746, 3546749, 3548139, 3548860, 3548912, 3548956, 3551173, 3551484, 3552405, 3553461, 3554222, 3555743, 3555796, 3556641, 3559130, 3561949, 3563451, 3564077, 3566848, 3567080, 3567757, 3568570, 3568585, 3569544, 3569892, 3571745, 3571769, 3572083, 3573272, 3574770, 3575155, 3575175, 3577760, 3578733, 3580810, 3580987, 3582767, 3582989, 3583704, 3584325, 3584933, 3585119, 3588066, 3588544, 3593684, 3593705, 3593727, 3593783, 3596925, 3597334, 3600647, 3601037, 3601323, 3602437, 3604158, 3604573, 3604709, 3605046, 3605869, 3611604, 3612767, 3612883, 3613125, 3613853, 3614083, 3616313, 3617443, 3617825, 3618468, 3619084, 3619997, 3620331, 3620385, 3622160, 3622891, 3623391, 3624321, 3624440, 3624980, 3625088, 3625106, 3625164, 3625565, 3625814, 3626400, 3627400, 3630841, 3630945, 3631015, 3632209, 3632438, 3633073, 3633826, 3634361, 3636556, 3637040, 3637282, 3637380, 3637608, 3637948, 3639090, 3640661, 3642125, 3643164, 3643531, 3643860, 3644937, 3646010, 3647745, 3648359, 3651829, 3654155, 3654618, 3655948, 3655972, 3655991, 3656724, 3657664, 3659054, 3659809, 3661080, 3661207, 3661771, 3662006, 3662069, 3662230, 3662520, 3663869, 3665105, 3665904, 3666146, 3668135, 3668710, 3668830, 3671769, 3673260, 3673278, 3674637, 3677577, 3677659, 3678824, 3680910, 3681182, 3681790, 3683032, 3683366, 3685712, 3685790, 3686720, 3687133, 3688625, 3689408, 3692169, 3692406, 3694885, 3695918, 3696123, 3696397, 3697085, 3697413, 3698472, 3699452, 3699701, 3701985, 3704433, 3704930, 3705728, 3709107, 3709872, 3712549, 3713486, 3713882, 3714511, 3714820, 3715887, 3716441, 3717378, 3717591, 3718909, 3719972, 3720047, 3720805, 3722642, 3723059, 3723326, 3724204, 3724272, 3724348, 3724763, 3726006, 3726685, 3727400, 3728860, 3729796, 3729904, 3732041, 3732383, 3732847, 3733136, 3733153, 3736718, 3736964, 3739766, 3739886, 3745972, 3746017, 3747179, 3747450, 3747476, 3750238, 3753253, 3753665, 3754557, 3758470, 3758775, 3759669, 3760061, 3760809, 3761522, 3764240, 3765542, 3765823, 3766786, 3767011, 3770231, 3770370, 3771459, 3771620, 3771804, 3773243, 3773275, 3774228, 3776229, 3777340, 3777344, 3777926, 3780272, 3780470, 3780488, 3780522, 3780699, 3781046, 3781869, 3782570, 3782729, 3782842, 3782988, 3784963, 3785325, 3787626, 3789036, 3789978, 3796278, 3800164, 3800499, 3802618, 3803225, 3804216, 3805394, 3807839, 3808655, 3812137, 3812745, 3812905, 3812917, 3813166, 3813588, 3813835, 3814054, 3815048, 3816659, 3816931, 3818353, 3822655, 3822961, 3823058, 3823160, 3823372, 3823894, 3825213, 3825329, 3829558, 3831452, 3832244, 3832560, 3833061, 3834384, 3837815, 3839947, 3840364, 3843252, 3843479, 3843863, 3844529, 3846192, 3846215, 3846955, 3847455, 3847715, 3849031, 3849356, 3849549, 3851147, 3851995, 3852743, 3853410, 3858627, 3859731, 3860420, 3860859, 3862846, 3864173, 3866247, 3867079, 3867665, 3868860, 3868926, 3869604, 3870322, 3871353, 3871783, 3872843, 3874258, 3875281, 3875447, 3876140, 3877582, 3878306, 3879546, 3880030, 3880247, 3882026, 3882612, 3882927, 3885654, 3888059, 3889771, 3889975, 3890760, 3891602, 3891892, 3894531, 3894760, 3895181, 3896863, 3897055, 3898639, 3898709, 3899162, 3900377, 3901099, 3901477, 3902105, 3902403, 3902437, 3903596, 3904618, 3905399, 3907811, 3907891, 3909162, 3909782, 3910231, 3911174, 3912333, 3913588, 3914728, 3916021, 3917097, 3918808, 3918917, 3919950, 3920742, 3921174, 3921207, 3921247, 3923187, 3924365, 3925136, 3925986, 3926639, 3927772, 3927834, 3928484, 3929842, 3930068, 3930232, 3931751, 3932007, 3932140, 3933281, 3933627, 3933738, 3933838, 3933867, 3933870, 3933871, 3934467, 3934941, 3936247, 3937055, 3937744, 3938569, 3938795, 3939310, 3940024, 3940364, 3944275, 3945438, 3945968, 3946033, 3946234, 3948414, 3951432, 3953008, 3953061, 3953088, 3955011, 3955753, 3955960, 3957350, 3958119, 3958595, 3960017, 3960444, 3962704, 3962967, 3963942, 3964635, 3968910, 3969379, 3970222, 3973322, 3974369, 3976088, 3976248, 3976876, 3978108, 3983367, 3984378, 3985447, 3987803, 3991380, 3992188, 3993052, 3995367, 3996479, 3998539, 3999809, 3999926, 3999953, 4000285, 4001049, 4001705, 4002035, 4002674, 4003453, 4006402, 4010821, 4011042, 4012534, 4013258, 4013479, 4014267, 4014388, 4015064, 4015828, 4016248, 4016775, 4019369, 4020406, 4021194, 4022005, 4023948, 4024674, 4025219, 4025704, 4026217, 4027603, 4028617, 4029297, 4033483, 4034498, 4034522, 4035918, 4036187, 4039605, 4041407, 4043205, 4043520, 4044117, 4044389, 4045935, 4046110, 4048162, 4048230, 4049981, 4052818, 4054360, 4054494, 4054674, 4055617, 4057746, 4059351, 4059876, 4062171, 4062811, 4063130, 4063927, 4065569, 4065973, 4066388, 4066917, 4067883, 4068678, 4070580, 4070758, 4073303, 4075940, 4076772, 4077066, 4077315, 4078040, 4078438, 4080589, 4081073, 4085551, 4085890, 4089109, 4089704, 4089800, 4091208, 4092215, 4092521, 4092881, 4093117, 4094211, 4095913, 4097940, 4098043, 4099584, 4100407, 4100834, 4102239, 4102738, 4103833, 4104377, 4104741, 4105333, 4105802, 4106225, 4106513, 4107308, 4107603, 4108549, 4109234, 4109365, 4110415, 4111188, 4111196, 4112532, 4112977, 4114333, 4115344, 4115737, 4115842, 4118469, 4118673, 4120004, 4120697, 4121409, 4121495, 4122487, 4122590, 4122925, 4124682, 4124688, 4125437, 4126323, 4126575, 4130301, 4130412, 4132027, 4132047, 4133382, 4135955, 4136277, 4137146, 4137832, 4140204, 4141518, 4142233, 4142901, 4143627, 4145288, 4147437, 4148588, 4148744, 4149140, 4149999, 4150786, 4151270, 4152855, 4154266, 4154508, 4156519, 4157576, 4158572, 4158646, 4158741, 4159763, 4160099, 4160743, 4160826, 4161001, 4161512, 4161640, 4162538, 4162539, 4163354, 4164194, 4164792, 4167981, 4168358, 4168980, 4169083, 4170036, 4170566, 4171227, 4174131, 4174842, 4176250, 4176260, 4179165, 4179297, 4182834, 4186552, 4187384, 4188026, 4190081, 4190783, 4191533, 4191585, 4191679, 4192427, 4193782, 4196255, 4196768, 4197166, 4199196, 4199975, 4200202, 4202630, 4202653, 4203332, 4203380, 4203586, 4204369, 4205361, 4205504, 4206341, 4207965, 4208144, 4209519, 4210542, 4211288, 4211332, 4211989, 4212636, 4214703, 4215267, 4215665, 4216745, 4216929, 4217897, 4220197, 4220746, 4221344, 4222222, 4224064, 4224780, 4224924, 4225267, 4227099, 4227215, 4227972, 4228400, 4228418, 4228446, 4230330, 4231146, 4232539, 4232568, 4232693, 4234289, 4235507, 4236022, 4238103, 4238524, 4241200, 4241594, 4241850, 4242785, 4243146, 4243582, 4243622, 4244026, 4245329, 4245364, 4245471, 4245710, 4248578, 4251185, 4251262, 4251482, 4251558, 4254375, 4254743, 4255414, 4256951, 4257358, 4257625, 4258786, 4258879, 4259446, 4260204, 4260541, 4260922, 4261801, 4261872, 4263481, 4264882, 4265311, 4265664, 4265709, 4265729, 4266015, 4266356, 4266588, 4269156, 4270200, 4270560, 4274223, 4278456, 4282118, 4282468, 4283301, 4283433, 4284723, 4284786, 4284967, 4285072, 4285170, 4285487, 4287030, 4287055, 4290482, 4290516, 4291625, 4292469, 4292626, 4292896, 4292933, 4293519, 4297366, 4297434, 4299769, 4299838, 4299949, 4300434, 4300547, 4302135, 4302722, 4305459, 4305897, 4306254, 4306403, 4310206, 4310245, 4310521, 4310928, 4311144, 4312534, 4318204, 4319472, 4319863, 4321410, 4322372, 4322534, 4322895, 4322907, 4322946, 4323075, 4324904, 4326998, 4327367, 4329274, 4329407, 4330239, 4330247, 4330677, 4331301, 4333114, 4334001, 4334519, 4334624, 4334738, 4335254, 4336909, 4338223, 4340695, 4341705, 4342458, 4344301, 4344544, 4346221, 4346408, 4349186, 4351063, 4351506, 4351751, 4352545, 4352641, 4353515, 4354830, 4355333, 4356023, 4356573, 4356731, 4357605, 4357663, 4357735, 4359082, 4359408, 4359753, 4359786, 4360011, 4361591, 4362490, 4363380, 4363484, 4364202, 4364932, 4364979, 4369376, 4373200, 4373284, 4375670, 4377467, 4378802, 4380116, 4380148, 4381224, 4384448, 4384955, 4385584, 4386195, 4387168, 4387211, 4388201, 4388747, 4389304, 4390669, 4390829, 4392254, 4392358, 4392725, 4395062, 4396259, 4397616, 4399292, 4399950, 4400392, 4400813, 4402162, 4402449, 4402525, 4402532, 4402725, 4402742, 4403415, 4403873, 4405581, 4405921, 4407806, 4410864, 4411317, 4411323, 4411985, 4413489, 4413782, 4414668, 4415211, 4417160, 4417563, 4418379, 4418797, 4419069, 4419483, 4419838, 4421628, 4425454, 4425734, 4426252, 4426260, 4426380, 4426691, 4428529, 4430912, 4431845, 4435000, 4436474, 4436648, 4438295, 4438379, 4440273, 4440893, 4440895, 4442783, 4444078, 4444533, 4446041, 4446817, 4446832, 4447947, 4448769, 4450645, 4451756, 4452138, 4453506, 4453617, 4453863, 4455145, 4455780, 4457631, 4458171, 4460670, 4461082, 4466326, 4468239, 4468637, 4469701, 4470165, 4471080, 4472645, 4474250, 4475370, 4475433, 4476690, 4480689, 4482308, 4483070, 4483255, 4483392, 4484010, 4484223, 4485611, 4488237, 4490171, 4492643, 4494098, 4494622, 4495405, 4495984, 4496128, 4498024, 4498279, 4501046, 4502552, 4503286, 4504471, 4505394, 4505499, 4506340, 4507535, 4507619, 4508407, 4511212, 4511301, 4511349, 4512600, 4513113, 4513229, 4513434, 4516038, 4516470, 4516565, 4517651, 4517804, 4517884, 4518566, 4518679, 4519400, 4520893, 4522694, 4524766, 4526627, 4526913, 4527105, 4528918, 4529040, 4529095, 4529120, 4530283, 4530930, 4533704, 4535854, 4536334, 4536338, 4536715, 4538287, 4540639, 4541696, 4543836, 4544265, 4544302, 4544816, 4545230, 4545589, 4545789, 4545869, 4547405, 4547549, 4548366, 4549551, 4549679, 4550019, 4550701, 4551620, 4554228, 4554791, 4554796, 4557246, 4557605, 4558568, 4559849, 4560010, 4560284, 4564542, 4566659, 4567188, 4567698, 4568250, 4571188, 4571527, 4572480, 4573255, 4573767, 4574008, 4575760, 4575776, 4575798, 4577846, 4578211, 4578603, 4578895, 4579213, 4580344, 4580843, 4580963, 4583778, 4583942, 4585146, 4585351, 4586254, 4587581, 4588423, 4590276, 4593681, 4594965, 4595129, 4597851, 4599334, 4601327, 4603480, 4605268, 4607347, 4607890, 4610406, 4610912, 4611653, 4612366, 4612794, 4613374, 4618124, 4620988, 4621324, 4621799, 4622020, 4622637, 4623067, 4623085, 4623654, 4624408, 4625170, 4626833, 4628216, 4631183, 4632534, 4633273, 4634681, 4634762, 4634894, 4635353, 4637475, 4637914, 4641513, 4642591, 4646680, 4647471, 4651102, 4655238, 4655256, 4657013, 4658892, 4659804, 4661579, 4662635, 4662781, 4662925, 4663748, 4664122, 4664493, 4664783, 4665338, 4666088, 4666230, 4666518, 4667791, 4669262, 4669893, 4674604, 4676583, 4677950, 4678249, 4682128, 4682539, 4682693, 4682941, 4683921, 4687717, 4688060, 4690108, 4690443, 4691079, 4692626, 4693990, 4695023, 4695094, 4695782, 4695834, 4699102, 4699167, 4702056, 4702321, 4703516, 4703638, 4705990, 4706914, 4707843, 4708073, 4708384, 4708869, 4709163, 4709669, 4710309, 4713897, 4715384, 4716058, 4719438, 4720115, 4722858, 4723154, 4726105, 4726942, 4727589, 4728533, 4729743, 4730187, 4730440, 4732143, 4734183, 4736140, 4737935, 4740257, 4740627, 4741337, 4741651, 4742258, 4745580, 4745900, 4748100, 4750834, 4754269, 4754893, 4755291, 4756232, 4756297, 4758699, 4759146, 4761871, 4761990, 4762157, 4762489, 4762872, 4763422, 4763531, 4764165, 4764972, 4766890, 4767714, 4768575, 4769784, 4769852, 4770305, 4770323, 4771416, 4772456, 4773015, 4773955, 4774229, 4775500, 4776519, 4777115, 4779821, 4780228, 4781065, 4783585, 4783684, 4783720, 4785912, 4791258, 4791786, 4792865, 4793193, 4793216, 4794559, 4794695, 4794769, 4795024, 4795057, 4796599, 4797335, 4797362, 4798296, 4798435, 4799772, 4799777, 4800572, 4801274, 4801410, 4802731, 4804010, 4808428, 4808734, 4809056, 4811165, 4811248, 4811524, 4812458, 4812539, 4817269, 4817764, 4818938, 4819148, 4819298, 4820437, 4822316, 4822822, 4824721, 4825911, 4826491, 4827210, 4827926, 4828071, 4828446, 4828622, 4829400, 4831868, 4831995, 4833161, 4835154, 4836338, 4838074, 4839346, 4840539, 4840859, 4841005, 4841607, 4842516, 4842748, 4843031, 4843042, 4843189, 4843457, 4843845, 4845577, 4846770, 4847583, 4851380, 4851389, 4852653, 4856006, 4856585, 4857564, 4857956, 4858119, 4862295, 4862781, 4865327, 4867113, 4867782, 4869022, 4869890, 4870304, 4871068, 4873675, 4874124, 4874813, 4877325, 4879796, 4881122, 4884432, 4886105, 4886194, 4887869, 4889754, 4890170, 4892498, 4892568, 4893012, 4893330, 4893581, 4894120, 4894680, 4895466, 4895564, 4896198, 4896268, 4897493, 4898653, 4899040, 4900528, 4900552, 4900891, 4906441, 4907715, 4908724, 4909858, 4910018, 4910529, 4914843, 4915113, 4916939, 4918265, 4918585, 4919202, 4920230, 4923551, 4924965, 4925269, 4925379, 4926148, 4926469, 4927454, 4927611, 4929579, 4931938, 4932128, 4933418, 4933828, 4935478, 4937918, 4937932, 4940180, 4941607, 4942474, 4946464, 4947530, 4949763, 4950055, 4950092, 4950504, 4950987, 4951992, 4952513, 4952835, 4952924, 4953089, 4954223, 4954966, 4956018, 4959778, 4960226, 4960402, 4961198, 4961254, 4961961, 4962335, 4962589, 4963126, 4964402, 4964447, 4964785, 4965991, 4966583, 4966825, 4968410, 4969044, 4969248, 4971531, 4973100, 4974231, 4974246, 4974702, 4975711, 4977118, 4977505, 4978574, 4979304, 4979458, 4980316, 4980675, 4982340, 4982583, 4982675, 4983949, 4986022, 4987238, 4987883, 4989047, 4991516}; 


    for (int i = 0; i < 10; i++)
    {
        uint64_t counter = 0;
        iter_info info(0);
        t.start();
#pragma omp parallel for num_threads(THREAD_NUM)
        for (int i = 0; i < THREAD_NUM; i++)
        {
            GraphBase* graph = graphEngine.create_graph_handle();
            adjlist found;

            // OutCursor* out_cursor = graph->get_outnbd_iter();
            // out_cursor->set_key_range(graphEngine.get_key_range(i));
            // out_cursor->next(&found);
            // while (found.node_id != -1)
            // {
            //     for (node_id_t v : found.edgelist)
            //     {
            //         counter += 1;
            //     }
            //     found.clear();
            //     out_cursor->next(&found);
            //     // std::cout << found.node_id << " " << counter << "\n";
            // }

            for(int j = 0; j < sampled.size(); j++) {
                if (sampled[j] >= graphEngine.get_key_range(i).start && sampled[j] < graphEngine.get_key_range(i).end) {
                    std::vector<node_id_t> v = graph->get_out_nodes_id(sampled[j]); 
                }
            }
 
            if (opts.is_directed)
            {
                // InCursor* in_cursor = graph->get_innbd_iter();
                // in_cursor->set_key_range(graphEngine.get_key_range(i));
                // in_cursor->next(&found);
                // while (found.node_id != -1)
                // {
                //     for (node_id_t v : found.edgelist)
                //     {
                //         counter += 1;
                //     }
                //     found.clear();
                //     in_cursor->next(&found);
                // }

                // for(int j = 0; j < sampled.size(); j++) {
                //     if (sampled[j] >= graphEngine.get_key_range(i).start && sampled[j] < graphEngine.get_key_range(i).end) {
                //         std::vector<node_id_t> v = graph->get_in_nodes_id(sampled[j]);
                //     }
                // }
            }
            graph->close();
        }
        t.stop();
        info.time_taken = t.t_micros();
        std::cout << "Iteration over all edges completed in : "
                  << info.time_taken << std::endl;
    }

    return 0;
}